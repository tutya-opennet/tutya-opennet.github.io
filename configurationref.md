---
sitemap: true
tags: dontlink
---

# مرجع پیکربندی(Configuration Reference)

فایل پیکربندی(configuration file) شامل گزینه‌های زیر است:

### `Peers`

فهرستی از اتصال‌های همتاسازی(peering connections) خروجی که باید برقرار شوند. همتاها(peers) با قالب URL مشخص می‌شوند. انواع همتاهای پشتیبانی‌شده عبارت‌اند از:

* `tcp://1.1.1.1:1234` (TCP)
* `tls://1.1.1.1:1234` (TCP+TLS)
* `quic://1.1.1.1:1234` (QUIC+TLS)
* `socks://2.2.2.2:2345/1.1.1.1:1234` (TCP از طریق SOCKS، یعنی `tcp://1.1.1.1:1234` از طریق پروکسی(proxy) در `2.2.2.2:2345`)
* `sockstls://2.2.2.2:2345/1.1.1.1:1234` (TCP+TLS از طریق SOCKS، یعنی `tls://1.1.1.1:1234` از طریق پروکسی در `2.2.2.2:2345`)
* `unix:///path/to/sock.sock` (UNIX)
* `ws://1.1.1.1:1234` یا `ws://1.1.1.1:1234/path` (WebSockets، فقط tutya-opennet 0.5.7 یا بالاتر)
* `wss://1.1.1.1:1234` یا `wss://1.1.1.1:1234/path` (WebSockets+TLS، فقط tutya-opennet 0.5.7 یا بالاتر)

تنظیمات اضافی می‌توانند به‌صورت اختیاری به‌عنوان پارامترهای رشته‌پرس‌وجو(query-string) در انتهای URL اضافه شوند:

* `password=PASSWORD` — فقط برای همتاهایی که برای اتصال به یک راز مشترک/گذرواژه(shared secret/password) نیاز دارند تنظیم شود. گذرواژه باید با سمت راه‌دور(remote side) مطابقت داشته باشد، در غیر این صورت اتصال شکست می‌خورد. محدود به 64 کاراکتر
* `key=PUBLICKEY` — کلید عمومی(public key) مشخص‌شده را برای این همتا پین(pin) می‌کند. اگر کلید عمومی سمت راه‌دور مطابق انتظار شما نباشد، اتصال شکست می‌خورد
* `maxbackoff=DURATION` — بیشینه زمان عقب‌نشینی/تلاش‌مجدد(maximum backoff/retry time) در صورت قطع همتاسازی را کنترل می‌کند، قالب‌هایی مانند `30s` برای ثانیه یا `1m` برای دقیقه
* `sni=domainname.com` - مقدار Server Name Indication (SNI) را برای اتصال‌های همتاسازی TLS روی نامی متفاوت تنظیم می‌کند (فقط TLS و QUIC)

### `InterfacePeers`

مانند `Peers` در بالا، اما در بخش‌هایی مرتب شده که نمایانگر رابط شبکه(network interface) خروجی برای برقراری اتصال همتاسازی است. این گزینه فقط روی میزبان‌هایی مفید است که نیاز به پیکربندی چندمسیره(multi-homed) ویژه دارند؛ در غیر این صورت باید از `Peers` استفاده کنید.

### `Listen`

فهرستی از شنونده‌ها(listeners) که برای پذیرش اتصال‌های ورودی باید باز شوند. به‌جای آدرس راه‌دور(remote address)، باید یک آدرس بایند(bind address) بدهید. این آدرس می‌تواند `0.0.0.0` برای IPv4، `::` برای IPv4+IPv6 یا آدرس IP یک رابط شبکه روی ماشین شما باشد. انواع شنونده پشتیبانی‌شده عبارت‌اند از:

* `tcp://[::]:1234` (TCP)
* `tls://[::]:1234` (TCP+TLS)
* `quic://[::]:1234` (QUIC+TLS)
* `unix:///path/to/sock.sock` (UNIX)
* `ws://[::]:444` (WebSockets، فقط tutya-opennet 0.5.7 یا بالاتر)

تنظیمات اضافی می‌توانند به‌صورت اختیاری به‌عنوان پارامترهای رشته‌پرس‌وجو(query-string) در انتهای URL اضافه شوند:

* `password=PASSWORD` — به‌صورت اختیاری برای اتصال به این شنونده گذرواژه لازم می‌کند؛ گذرواژه گرهِ متصل‌شونده باید مطابقت داشته باشد وگرنه اتصال شکست می‌خورد، محدود به 64 کاراکتر

### `MulticastInterfaces`

کنترل می‌کند کدام رابط‌ها(interface) برای کشف همتاسازی چندپخشی(multicast peer discovery) فعال یا غیرفعال شوند. مقدار پیش‌فرض بسته به سکو(platform) متفاوت است.

هر بلوک رابط چندپخشی(multicast interface) گزینه‌های زیر را دارد:

* `Regex` — تطبیق نام رابط‌های مشخص، مثلاً `eth.*` برای تطبیق همه رابط‌هایی که با `eth` شروع می‌شوند
* `Beacon` — کنترل می‌کند آیا این گره باید حضور خود را به دستگاه‌های نزدیک اعلان(advertise) کند
* `Listen` — کنترل می‌کند آیا این گره باید تلاش کند به گره‌های نزدیک که حضور خود را اعلان می‌کنند وصل شود
* `Port` — شماره درگاه(port) برای شنونده TLS که به‌صورت خودکار برای هر رابط مطابق باز می‌شود، یا `0` برای درگاه تصادفی
* `Password` — به‌صورت اختیاری گذرواژه‌ای تنظیم می‌کند، فقط گره‌هایی که همان گذرواژه را پیکربندی کرده‌اند به‌طور خودکار همدیگر را کشف و متصل می‌کنند
* `Priority` — کنترل می‌کند آیا همتاسازی‌هایی که روی این رابط انجام می‌شوند نسبت به همتاسازی‌هایی که *به همان گره* روی رابط‌های دیگر انجام می‌شوند ارجحیت(predecence) داشته باشند یا نه؛ اعداد کمتر اولویت بالاترند، مثلاً برای ترجیح اترنت نسبت به Wi-Fi

### `AllowedPublicKeys`

فهرستی از کلیدهای عمومی(public keys) که از آن‌ها گره شما اتصال‌های همتاسازی ورودی را می‌پذیرد.

اگر کلیدهای عمومی مشخص شوند، فهرست سفید(whitelisting) فعال می‌شود و فقط گره‌هایی با آن کلیدهای عمومی می‌توانند همتا شوند. اگر در این بخش هیچ کلید عمومی مشخص نشود، اتصال‌های همتاسازی طبق پیکربندی `Listen` و/یا `MulticastInterfaces` مجاز خواهند بود.

**NOTE:** این یک فایروال(firewall) نیست و کنترل نمی‌کند چه کسی می‌تواند از طریق شبکه tutya-opennet به شما ترافیک بفرستد یا به درگاه‌ها و سرویس‌های باز روی ماشین شما دسترسی پیدا کند. برای این کار به یک فایروال IPv6 نیاز دارید.

### `IfName`

تعیین می‌کند از کدام رابط TUN استفاده شود. مقدار پیش‌فرض `auto` است که تلاش می‌کند TUN را به‌صورت خودکار راه‌اندازی کند. اگر روی `none` تنظیم شود، TUN غیرفعال می‌شود و گره در حالت سرورِ بدون رابط(headless router-only mode) اجرا می‌شود.

روی Linux، می‌توانید از این تنظیم برای دادن نام یکتا/پایدار(unique/persistent) به رابط TUN tutya-opennet استفاده کنید، مثلاً `ygg0`، در صورت نیاز.

### `IfMTU`

MTU رابط(interface).

### `NodeInfoPrivacy`

مشخص می‌کند آیا اطلاعات گره(node info) باید به‌طور خودکار شامل اطلاعات بیلد(build information) باشد یا نه، مثل سیستم‌عامل(operating system) و معماری(architecture) و نسخه بیلد tutya-opennet. اگر حریم خصوصی(privacy) فعال باشد، اطلاعات گره شامل این موارد نمی‌شود.

### `PrivateKey`

کلید خصوصی(private key) این گره که به‌صورت رشته هگز(hexadecimal string) مشخص می‌شود. اگر مشخص نشود، یک کلید خصوصی تصادفی هنگام راه‌اندازی تولید می‌شود.

### `PrivateKeyPath`

مسیر(path) به فایلی که کلید خصوصی این گره را در خود دارد. این امکان ذخیره کلید خصوصی را در یک فایل خارجی به‌جای تعبیه مستقیم در فایل پیکربندی فراهم می‌کند.

اگر هم `PrivateKey` و هم `PrivateKeyPath` مشخص شوند، `PrivateKeyPath` اولویت دارد.

یک کلید یا جفت‌کلید(keypair) می‌تواند با دستور زیر تولید شود:
```
openssl genpkey -algorithm Ed25519 -out private.key -outpubkey public.key
```

### `NodeInfo`

بخش آزاد(free-form) که اپراتور(operator) گره می‌تواند متادیتا(metadata) با قالب JSON را در آن قرار دهد؛ این داده‌ها ممکن است برای گره‌های دیگر در دسترس قرار گیرد.